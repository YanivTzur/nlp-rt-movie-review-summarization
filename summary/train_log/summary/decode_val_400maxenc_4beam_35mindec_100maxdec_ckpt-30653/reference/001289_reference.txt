tyler perry and matthew fox do their best , but they 're trampled by rob cohen 's frustrating direction and a tasteless , lazily written screenplay .